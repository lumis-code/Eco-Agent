<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Eco Score</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { background-color: #121212; color: #e5e7eb; font-family: 'Inter', sans-serif; }
.progress-bar { height: 40px; border-radius: 20px; background-color: #374151; overflow: hidden; margin-bottom: 16px; }
.progress-fill { height: 100%; width: 0%; text-align: center; font-weight: bold; line-height: 40px; transition: width 1s ease-in-out, background-color 1s; color: white; font-size: 1.1rem; }
.card { background: linear-gradient(145deg, #1f2937, #111827); border-radius: 16px; padding: 16px; margin-bottom: 12px; transition: transform 0.3s, box-shadow 0.3s, background 0.3s; cursor: pointer; }
.card:hover { transform: translateY(-6px) scale(1.02); box-shadow: 0 12px 24px rgba(0,255,150,0.5); background: linear-gradient(145deg, #10b981, #14b8a6); }
.tooltip { position: relative; display: inline-block; cursor: pointer; }
.tooltip .tooltiptext { visibility: hidden; width: 240px; background-color: #111827; color: #fff; text-align: center; padding: 6px; border-radius: 6px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -120px; opacity: 0; transition: opacity 0.3s; font-size: 0.85rem; }
.tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
.confetti { position: fixed; top: 0; left: 0; width: 100%; height: 0; pointer-events: none; z-index: 9999; }
.confetti-piece { position: absolute; opacity: 0.9; border-radius: 50%; }
</style>
</head>
<body>

<header class="bg-green-800 text-white py-6 text-center">
  <h1 class="text-3xl font-bold">Ultimate Eco Score</h1>
  <p class="mt-2 text-green-300">Track your carbon footprint & get actionable steps instantly!</p>
</header>

<main class="max-w-4xl mx-auto mt-6 p-6 bg-gray-900 rounded-xl shadow-lg">

  <h2 class="text-2xl font-semibold text-green-400 mb-4">Enter Your Habits</h2>

  <div class="mb-6">
    <label class="block mb-1 font-medium" for="car">ðŸš— Car commute (days/week): <span id="carVal">5</span></label>
    <input type="range" id="car" min="0" max="7" value="5" class="w-full">
  </div>

  <div class="mb-6">
    <label class="block mb-1 font-medium" for="meat">ðŸ¥© Meat meals (days/week): <span id="meatVal">5</span></label>
    <input type="range" id="meat" min="0" max="7" value="5" class="w-full">
  </div>

  <div class="mb-6">
    <label class="block mb-1 font-medium" for="energy">ðŸ’¡ Energy-saving habits (0â€“3): <span id="energyVal">1</span></label>
    <input type="range" id="energy" min="0" max="3" value="1" class="w-full">
  </div>

  <div class="mb-6">
    <label class="block mb-1 font-medium" for="ev">âš¡ What-if: Switch to EV? </label>
    <input type="range" id="ev" min="0" max="1" value="0" class="w-full">
  </div>
  <div class="progress-bar">
    <div id="progress" class="progress-fill">0</div>
  </div>
  <p class="text-center text-green-300 font-semibold text-lg mb-6" id="ecoScoreText">0 kg COâ‚‚ / month</p>
  <div id="co2Breakdown" class="card"></div>
  <div id="plan" class="card"></div>
  <div id="equivalent" class="text-gray-300 mt-4 text-sm"></div>

</main>

<footer class="mt-6 p-4 text-center text-gray-400 text-sm">
  Data sources: EPA 2025, FAO 2024, Our World in Data
</footer>

<div class="confetti" id="confetti"></div>

<script>
const carSlider = document.getElementById('car');
const meatSlider = document.getElementById('meat');
const energySlider = document.getElementById('energy');
const evSlider = document.getElementById('ev');

const carVal = document.getElementById('carVal');
const meatVal = document.getElementById('meatVal');
const energyVal = document.getElementById('energyVal');

carSlider.oninput = updateValues;
meatSlider.oninput = updateValues;
energySlider.oninput = updateValues;
evSlider.oninput = updateValues;

function animateNumber(element, start, end, duration) {
  let startTime = null;
  function step(timestamp) {
    if (!startTime) startTime = timestamp;
    let progress = timestamp - startTime;
    let value = Math.min(Math.round(start + (end - start) * (progress / duration)), end);
    element.textContent = value;
    if (progress < duration) window.requestAnimationFrame(step);
  }
  window.requestAnimationFrame(step);
}

function showConfetti() {
  const confettiContainer = document.getElementById('confetti');
  confettiContainer.style.height = '100vh';
  const colors = ['#10b981','#facc15','#3b82f6','#f472b6','#ef4444','#14b8a6','#22d3ee'];
  for(let i=0;i<150;i++){
    const confetti = document.createElement('div');
    confetti.className = 'confetti-piece';
    confetti.style.width = `${Math.random()*8 + 6}px`;
    confetti.style.height = `${Math.random()*8 + 6}px`;
    confetti.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
    confetti.style.left = Math.random()*100 + 'vw';
    confetti.style.top = '-10px';
    confetti.style.opacity = 0.9;
    const duration = Math.random()*2 + 3;
    confetti.style.transition = `transform ${duration}s linear, top ${duration}s linear`;
    confettiContainer.appendChild(confetti);
    setTimeout(()=>{
      const swing = Math.random()*120 - 60;
      confetti.style.top = '100vh';
      confetti.style.transform = `translateX(${swing}px) rotate(${Math.random()*720}deg)`;
    },10);
    setTimeout(()=>confetti.remove(), 4000);
  }
}

function calculateCO2() {
  const carDays = parseInt(carSlider.value);
  const meatDays = parseInt(meatSlider.value);
  const energyLevel = parseInt(energySlider.value);
  const ev = parseInt(evSlider.value);

  const avgKmPerDay = 30;
  const co2PerKm = ev ? 0.05 : 0.2;
  const co2Car = Math.round(carDays * co2PerKm * avgKmPerDay * 4);

  const co2Meat = Math.round(meatDays * 1.8 * 4);
  const co2Energy = Math.round((3 - energyLevel) * 10);

  const totalCO2 = co2Car + co2Meat + co2Energy;

  let ecoScore = Math.max(0, Math.min(100, Math.round(100 - totalCO2/3)));
  const progress = document.getElementById('progress');
  progress.style.width = ecoScore + '%';
  progress.textContent = ecoScore + '/100';
  if(ecoScore<40) progress.style.backgroundColor = "#ef4444";
  else if(ecoScore<70) progress.style.backgroundColor = "#facc15";
  else progress.style.backgroundColor = "#10b981";

  animateNumber(document.getElementById('ecoScoreText'), 0, totalCO2, 1000);

  document.getElementById('co2Breakdown').innerHTML = `
    <strong>Breakdown:</strong><br>
    <span class="tooltip">Transport: ${co2Car} kg COâ‚‚
      <span class="tooltiptext">0.2 kg/km Ã— 30 km/day Ã— ${carDays} days/week Ã— 4 weeks</span>
    </span><br>
    <span class="tooltip">Food: ${co2Meat} kg COâ‚‚
      <span class="tooltiptext">1.8 kg/day Ã— ${meatDays} days/week Ã— 4 weeks</span>
    </span><br>
    <span class="tooltip">Energy: ${co2Energy} kg COâ‚‚
      <span class="tooltiptext">Each missing energy habit = 10 kg/month</span>
    </span>
  `;

  const contributors = [
    {name: "Transport", value: co2Car},
    {name: "Food", value: co2Meat},
    {name: "Energy", value: co2Energy}
  ];
  contributors.sort((a,b)=>b.value - a.value);
  const mainDriver = contributors[0].name;

  let planHTML = `<strong>Primary Driver:</strong> ${mainDriver}<br><strong>Recommended Actions (monthly):</strong><ul>`;
  if(carDays>0) planHTML += `<li>Skip car commute 1â€“2 days/week â†’ save ~${Math.round(co2Car/2)} kg COâ‚‚</li>`;
  if(meatDays>0) planHTML += `<li>Have 1â€“2 meat-free meals/week â†’ save ~${Math.round(co2Meat/2)} kg COâ‚‚</li>`;
  if(energyLevel<3) planHTML += `<li>Increase energy-saving habits â†’ save ~${co2Energy} kg COâ‚‚</li>`;
  if(ev) planHTML += `<li>Using EV reduces transport COâ‚‚ drastically!</li>`;
  planHTML += '</ul>';
  document.getElementById('plan').innerHTML = planHTML;

  document.getElementById('equivalent').innerHTML = `
    Your COâ‚‚ is roughly equivalent to:<br>
    - Driving ${Math.round(totalCO2/co2PerKm)} km by car<br>
    - Absorbed by ${Math.round(totalCO2/40)} trees per year
  `;

  if(ecoScore>=85) showConfetti();
}

function updateValues() {
  carVal.textContent = carSlider.value;
  meatVal.textContent = meatSlider.value;
  energyVal.textContent = energySlider.value;
  calculateCO2();
}

updateValues();
</script>

</body>
</html>

